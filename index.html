<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë‚˜ì˜ KBO ë“œë¦¼íŒ€ ë§Œë“¤ê¸°</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
        .drag-over { background-color: rgba(59, 130, 246, 0.2) !important; }
        .stadium-bg {
            background-image: url('baseballpng.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }
        
        .player-card {
            width: 80px;
            height: 112px;
        }
        .player-card-mobile {
            width: 60px;
            height: 84px;
        }

        @media (min-width: 640px) {
            .player-card {
                width: 96px;
                height: 128px;
            }
        }
        
        /* ëª¨ë°”ì¼ì—ì„œ êµ¬ë‹¨ë³„ í˜„í™© 2x5 ê·¸ë¦¬ë“œ */
        @media (max-width: 639px) {
            .team-status-grid {
                display: grid;
                grid-template-columns: repeat(5, 1fr);
                gap: 8px;
            }
        }
        
        /* ë¼ì¸ì—… ìŠ¤í¬ë¡¤ë°” ìˆ¨ê¸°ê¸° (ì„ íƒ ì‚¬í•­) */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .no-scrollbar {
            -ms-overflow-style: none; /* IE and Edge */
            scrollbar-width: none; /* Firefox */
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-green-900 via-blue-900 to-purple-900">
    
    <header class="bg-black/80 backdrop-blur-md shadow-2xl border-b border-white/20">
        <div class="max-w-7xl mx-auto px-4 py-3">
            <div class="flex items-center justify-between">
                <div class="flex-1 min-w-0">
                    <h1 class="text-xl sm:text-3xl font-bold text-white tracking-tight truncate">
                        ë‚˜ì˜ KBO ë“œë¦¼íŒ€ ë§Œë“¤ê¸°
                    </h1>
                    <p class="text-gray-300 text-xs sm:text-base mt-1 font-medium truncate">
                        KBO 10ê°œ êµ¬ë‹¨ì—ì„œ í•œ ëª…ì”© ì„ íƒí•˜ì—¬ ìµœê°•ì˜ íŒ€ì„ êµ¬ì„±í•˜ì„¸ìš”
                    </p>
                </div>
                
                <div class="flex items-center space-x-3 flex-shrink-0">
                    <div class="bg-white/10 backdrop-blur px-3 py-2 rounded-xl border border-white/20">
                        <div class="text-center">
                            <div id="selectedCount" class="text-lg font-bold text-yellow-400">0/10</div>
                            <div class="text-xs text-gray-300">ì„ ìˆ˜</div>
                        </div>
                    </div>
                    
                    <button onclick="showRulesModal()" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-2 rounded-xl font-semibold transition-all flex items-center space-x-1 shadow-lg">
                        <span>â„¹ï¸</span>
                        <span class="hidden sm:inline text-sm">ê·œì¹™</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <div class="max-w-7xl mx-auto px-3 sm:px-6 py-4 sm:py-6">
        
        <div class="bg-gradient-to-r from-blue-900/30 to-purple-900/30 backdrop-blur rounded-xl p-3 mb-4 border border-blue-500/30">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-2">
                    <span class="text-blue-400">â„¹ï¸</span>
                    <span class="text-blue-300 font-semibold text-sm">ê·œì¹™</span>
                </div>
                <button onclick="showRulesModal()" class="text-blue-400 hover:text-blue-300 text-xs">
                    ìì„¸íˆ
                </button>
            </div>
            <div class="mt-2 text-xs text-blue-200 space-y-1">
                <div>â€¢ íƒ€ì 9ëª… + ì„ ë°œíˆ¬ìˆ˜ 1ëª… = ì´ 10ëª… êµ¬ì„± (êµ­ë‚´ ì„ ìˆ˜ë§Œ)</div>
                <div>â€¢ ê° êµ¬ë‹¨ì—ì„œ í•œ ëª…ì”©ë§Œ ì„ íƒ ê°€ëŠ¥</div>
                <div>â€¢ ë“œë˜ê·¸ë¡œ íƒ€ìˆœ ë³€ê²½ (íˆ¬ìˆ˜ ì œì™¸)</div>
            </div>
        </div>
       
        <div class="bg-white/5 backdrop-blur-lg rounded-xl p-3 mb-6 border border-white/20">
            <h3 class="text-md font-bold text-white mb-2 flex items-center justify-center sm:justify-start space-x-2">
                <span>ğŸ“Š</span>
                <span>êµ¬ë‹¨ë³„ ì‚¬ìš© í˜„í™©</span>
            </h3>
            <div id="teamStatus" class="flex justify-center flex-wrap team-status-grid">
                </div>
        </div>
        
        <div id="captureArea">
            <div class="mb-6 sm:mb-8">
                <div class="backdrop-blur-sm rounded-2xl sm:rounded-3xl p-4 sm:p-8 border border-white/20 shadow-2xl">

                    <div class="relative w-full max-w-4xl mx-auto">
                        <div class="relative w-full h-96 sm:h-[700px] rounded-xl stadium-bg stadium-container">
                            <div id="fieldPositions" class="relative w-full h-full">
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-white/10 backdrop-blur-lg rounded-xl p-4 sm:p-6 border border-white/20 shadow-xl mb-6">
                <h3 class="text-md font-bold text-white mb-4 flex items-center justify-center sm:justify-start space-x-2">
                    <span>âš¾</span>
                    <span>ë¼ì¸ì—… êµ¬ì„±</span>
                </h3>
                <div id="lineup" class="flex items-center justify-start sm:justify-center space-x-2 sm:space-x-3 overflow-x-auto pb-2 no-scrollbar">
                </div>

                <div class="text-center mt-4 text-xs sm:text-sm text-gray-300">
                    ğŸ’¡ íƒ€ì ì¹´ë“œë¥¼ ë“œë˜ê·¸í•˜ì—¬ íƒ€ìˆœì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
                </div>
            </div>
        </div>

        <div class="flex flex-col sm:flex-row items-center justify-center space-y-3 sm:space-y-0 sm:space-x-6">
            <button onclick="resetTeam()" class="w-full sm:w-auto bg-gray-600 hover:bg-gray-700 text-white px-6 py-3 rounded-xl font-semibold transition-all flex items-center justify-center space-x-2 shadow-lg">
                <span>ğŸ”„</span>
                <span>ë‹¤ì‹œ êµ¬ì„±í•˜ê¸°</span>
            </button>
            
            <button onclick="saveAsImage()" id="saveBtn" class="w-full sm:w-auto bg-green-600 hover:bg-green-700 disabled:bg-gray-500 disabled:cursor-not-allowed text-white px-6 py-3 rounded-xl font-semibold transition-all flex items-center justify-center space-x-2 shadow-lg">
                <span>ğŸ“·</span>
                <span>ì´ë¯¸ì§€ë¡œ ì €ì¥í•˜ê¸°</span>
            </button>
        </div>
    </div>

    <div id="playerSelectionModal" class="fixed inset-0 bg-black/90 backdrop-blur flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white/10 backdrop-blur-xl rounded-2xl p-6 max-w-2xl w-full border border-white/20">
            <div class="flex items-center justify-between mb-4">
                <h3 id="modalTitle" class="text-xl font-bold text-white">ì„ ìˆ˜ ì„ íƒ</h3>
                <button onclick="closePlayerModal()" class="w-8 h-8 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors flex items-center justify-center">
                    Ã—
                </button>
            </div>

            <div class="text-center text-sm text-gray-300 mb-4">
                ì‚¬ìš© ê°€ëŠ¥í•œ ëª¨ë“  ì„ ìˆ˜ê°€ í‘œì‹œë©ë‹ˆë‹¤ (ì§€ëª…íƒ€ìëŠ” ëª¨ë“  íƒ€ì ì„ íƒ ê°€ëŠ¥)
            </div>

            <div id="playerList" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-3 max-h-[70vh] overflow-y-auto">
                </div>
        </div>
    </div>

    <div id="rulesModal" class="fixed inset-0 bg-black/90 backdrop-blur flex items-center justify-center p-4 z-50 hidden">
        <div class="bg-white/10 backdrop-blur-xl rounded-2xl p-6 sm:p-8 max-w-lg w-full border border-white/20">
            <div class="text-center">
                <h3 class="text-xl sm:text-2xl font-bold text-white mb-4 sm:mb-6">ğŸ“‹ ë“œë¦¼íŒ€ êµ¬ì„± ê·œì¹™</h3>
                
                <div class="space-y-3 sm:space-y-4 text-left">
                    <div class="bg-blue-500/20 rounded-lg p-3 sm:p-4 border border-blue-500/30">
                        <h4 class="font-bold text-blue-300 mb-2">1ï¸âƒ£ ì„ ìˆ˜ êµ¬ì„±</h4>
                        <p class="text-white/90 text-sm">
                            íƒ€ì 9ëª… + ì„ ë°œíˆ¬ìˆ˜ 1ëª…ìœ¼ë¡œ<br/>
                            ì´ 10ëª…ì˜ ì„ ìˆ˜ë¥¼ êµ¬ì„±í•©ë‹ˆë‹¤.<br/>
                            <span class="text-blue-300 font-semibold">
                                (êµ­ë‚´ ì„ ìˆ˜ë§Œ í¬í•¨)
                            </span>
                        </p>
                    </div>
                    
                    <div class="bg-red-500/20 rounded-lg p-3 sm:p-4 border border-red-500/30">
                        <h4 class="font-bold text-red-300 mb-2">2ï¸âƒ£ íŒ€ ì œí•œ</h4>
                        <p class="text-white/90 text-sm">
                            KBO 10ê°œ êµ¬ë‹¨ì—ì„œ í•œ ëª…ì”©ë§Œ<br/>
                            ë°ë ¤ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br/>
                            <span class="text-red-300 font-semibold">
                                (í•œ íŒ€ì—ì„œ ë‘ ëª… ì´ìƒ ì„ íƒ ë¶ˆê°€)
                            </span>
                        </p>
                    </div>
                    
                    <div class="bg-green-500/20 rounded-lg p-3 sm:p-4 border border-green-500/30">
                        <h4 class="font-bold text-green-300 mb-2">3ï¸âƒ£ íƒ€ìˆœ ë³€ê²½</h4>
                        <p class="text-white/90 text-sm">
                            íƒ€ì ì¹´ë“œë¥¼ ë“œë˜ê·¸í•˜ì—¬<br/>
                            ììœ ë¡­ê²Œ íƒ€ìˆœì„ ë³€ê²½í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br/>
                            <span class="text-green-300 font-semibold">
                                (ì„ ë°œíˆ¬ìˆ˜ëŠ” ê³ ì •)
                            </span>
                        </p>
                    </div>
                </div>
                
                <button onclick="closeRulesModal()" class="mt-4 sm:mt-6 bg-blue-600 hover:bg-blue-700 text-white px-6 py-3 rounded-xl font-semibold transition-all w-full sm:w-auto">
                    í™•ì¸
                </button>
            </div>
        </div>
    </div>

    <footer class="bg-black/60 backdrop-blur border-t border-white/20 py-6 sm:py-8 mt-12 sm:mt-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 text-center">
            <div class="text-gray-400 text-sm leading-relaxed">
                <p class="mb-2">ë³¸ ì„œë¹„ìŠ¤ëŠ” ë¹„ì˜ë¦¬ ëª©ì ìœ¼ë¡œ ì œì‘ëœ íŒ¬í˜ì´ì§€ì…ë‹ˆë‹¤.</p>
                <p>ì„ ìˆ˜ ì‚¬ì§„, íŒ€ ë¡œê³ , ê¸°ë¡ì— ëŒ€í•œ ëª¨ë“  ì €ì‘ê¶Œì€ <span class="font-semibold text-white">KBO ë° ê° êµ¬ë‹¨</span>ì— ê·€ì†ë©ë‹ˆë‹¤.</p>
            </div>
            
            <div class="mt-4 sm:mt-6 pt-4 border-t border-gray-700">
                <div class="flex flex-col sm:flex-row justify-center items-center space-y-2 sm:space-y-0 sm:space-x-8 text-sm text-gray-500">
                    <div class="flex items-center space-x-2">
                        <span>âš¾</span>
                        <span>2024 KBO ì‹œì¦Œ</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span>ğŸ†</span>
                        <span>ë“œë¦¼íŒ€ ë§Œë“¤ê¸°</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <span>ğŸ“±</span>
                        <span>ëª¨ë°”ì¼ ì§€ì›</span>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script>
const positions = {
    'LF': { name: 'ì¢Œìµìˆ˜', x: '25%', y: '25%', mobileX: '15%', mobileY: '25%' },
    'CF': { name: 'ì¤‘ê²¬ìˆ˜', x: '50%', y: '15%', mobileX: '50%', mobileY: '10%' },
    'RF': { name: 'ìš°ìµìˆ˜', x: '75%', y: '25%', mobileX: '85%', mobileY: '25%' },
    'SS': { name: 'ìœ ê²©ìˆ˜', x: '38%', y: '45%', mobileX: '38%', mobileY: '37%' },
    '2B': { name: '2ë£¨ìˆ˜', x: '62%', y: '45%', mobileX: '62%', mobileY: '37%' },
    '3B': { name: '3ë£¨ìˆ˜', x: '31%', y: '69%', mobileX: '15%', mobileY: '60%' },
    '1B': { name: '1ë£¨ìˆ˜', x: '69%', y: '69%', mobileX: '85%', mobileY: '60%' },
    'C': { name: 'í¬ìˆ˜', x: '50%', y: '85%', mobileX: '50%', mobileY: '89%' },
    'DH': { name: 'ì§€ëª…íƒ€ì', x: '85%', y: '85%', mobileX: '80%', mobileY: '89%' },
    'P': { name: 'ì„ ë°œíˆ¬ìˆ˜', x: '50%', y: '60%', mobileX: '50%', mobileY: '63%' }
};

        const teams = {
            'KIA': { name: 'KIA íƒ€ì´ê±°ì¦ˆ', color: '#EA0029', subColor: '#000000', logo: 'ğŸ…' },
            'SSG': { name: 'SSG ëœë”ìŠ¤', color: '#CE0E2D', subColor: '#1C1C1C', logo: 'ğŸ¦…' },
            'LG': { name: 'LG íŠ¸ìœˆìŠ¤', color: '#C30452', subColor: '#FFFFFF', logo: 'ğŸ¦¬' },
            'ë‘ì‚°': { name: 'ë‘ì‚° ë² ì–´ìŠ¤', color: '#131230', subColor: '#FF6B35', logo: 'ğŸ»' },
            'NC': { name: 'NC ë‹¤ì´ë…¸ìŠ¤', color: '#315288', subColor: '#C4A484', logo: 'ğŸ¦–' },
            'KT': { name: 'KT ìœ„ì¦ˆ', color: '#000000', subColor: '#ED1C24', logo: 'ğŸ§™â€â™‚ï¸' },
            'í•œí™”': { name: 'í•œí™” ì´ê¸€ìŠ¤', color: '#FF6600', subColor: '#000000', logo: 'ğŸ¦…' },
            'ë¡¯ë°': { name: 'ë¡¯ë° ìì´ì–¸ì¸ ', color: '#041E42', subColor: '#C4122F', logo: 'âš“' },
            'ì‚¼ì„±': { name: 'ì‚¼ì„± ë¼ì´ì˜¨ì¦ˆ', color: '#074CA1', subColor: '#FFFFFF', logo: 'ğŸ¦' },
            'í‚¤ì›€': { name: 'í‚¤ì›€ íˆì–´ë¡œì¦ˆ', color: '#820024', subColor: '#570018', logo: 'ğŸ¦¸â€â™‚ï¸' }
        };

        // íƒ€ì ë°ì´í„°
        const players = {
            'LG': [
                { id: 'lg_1', name: 'ë¬¸ë³´ê²½', position: '3B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .292' },
                { id: 'lg_2', name: 'ë°•ë™ì›', position: 'C', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .259' },
                { id: 'lg_3', name: 'ë°•í•´ë¯¼', position: 'CF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .278' },
                { id: 'lg_4', name: 'ê¹€í˜„ìˆ˜', position: 'LF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .298' },
                { id: 'lg_5', name: 'êµ¬ë³¸í˜', position: 'SS', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .277' },
                { id: 'lg_6', name: 'ì‹ ë¯¼ì¬', position: '2B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .310' },
                { id: 'lg_7', name: 'ì˜¤ì§€í™˜', position: 'SS', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .239' },
                { id: 'lg_8', name: 'ë¬¸ì„±ì£¼', position: 'RF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .300' }
            ],
            'í•œí™”': [
                { id: 'hanwha_1', name: 'ìµœì¬í›ˆ', position: 'C', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .280' },
                { id: 'hanwha_2', name: 'ë…¸ì‹œí™˜', position: '3B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .233' },
                { id: 'hanwha_3', name: 'ë¬¸í˜„ë¹ˆ', position: 'LF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .322' },
                { id: 'hanwha_4', name: 'ì´ì§„ì˜', position: 'RF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .275' },
                { id: 'hanwha_5', name: 'ì±„ì€ì„±', position: '1B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .297' },
                { id: 'hanwha_6', name: 'í•˜ì£¼ì„', position: 'SS', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .283' },
                { id: 'hanwha_7', name: 'ì‹¬ìš°ì¤€', position: 'SS', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .212' },
                { id: 'hanwha_8', name: 'ê¹€íƒœì—°', position: '1B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .262' }
            ],
            'ë¡¯ë°': [
                { id: 'lotte_1', name: 'ìœ ê°•ë‚¨', position: 'C', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .285' },
                { id: 'lotte_2', name: 'ê³ ìŠ¹ë¯¼', position: '2B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .279' },
                { id: 'lotte_3', name: 'ìœ¤ë™í¬', position: 'RF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .278' },
                { id: 'lotte_4', name: 'ì „ì¤€ìš°', position: 'DH', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .288' },
                { id: 'lotte_5', name: 'í•œíƒœì–‘', position: '2B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .275' },
                { id: 'lotte_6', name: 'ì¥ë‘ì„±', position: 'CF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .276' },
                { id: 'lotte_7', name: 'ì „ë¯¼ì¬', position: 'SS', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .291' },
                { id: 'lotte_8', name: 'í™©ì„±ë¹ˆ', position: 'CF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .267' },
                { id: 'lotte_9', name: 'ì†í˜¸ì˜', position: '3B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .254' }
            ],
            'SSG': [
                { id: 'ssg_1', name: 'ë°•ì„±í•œ', position: 'SS', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .259' },
                { id: 'ssg_2', name: 'í•œìœ ì„¬', position: 'RF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .282' },
                { id: 'ssg_3', name: 'ìµœì§€í›ˆ', position: 'CF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .269' },
                { id: 'ssg_4', name: 'ì •ì¤€ì¬', position: '2B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .237' },
                { id: 'ssg_5', name: 'ì¡°í˜•ìš°', position: 'C', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .248' },
                { id: 'ssg_6', name: 'ìµœì •', position: 'DH', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .226' },
                { id: 'ssg_7', name: 'ê³ ëª…ì¤€', position: '1B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .271' },
                { id: 'ssg_8', name: 'ì˜¤íƒœê³¤', position: 'LF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .203' },
                { id: 'ssg_9', name: 'ì•ˆìƒí˜„', position: '3B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .261' }
            ],
            'KT': [
                { id: 'kt_1', name: 'ì•ˆí˜„ë¯¼', position: 'RF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .344' },
                { id: 'kt_2', name: 'ì¥ì„±ìš°', position: 'C', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .248' },
                { id: 'kt_3', name: 'í—ˆê²½ë¯¼', position: '3B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .279' },
                { id: 'kt_4', name: 'ê°•ë°±í˜¸', position: 'DH', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .263' },
                { id: 'kt_5', name: 'ê¹€ìƒìˆ˜', position: '2B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .253' },
                { id: 'kt_6', name: 'ì˜¤ìœ¤ì„', position: '2B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .256' },
                { id: 'kt_7', name: 'ê¶Œë™ì§„', position: 'SS', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .231' },
                { id: 'kt_8', name: 'í™©ì¬ê· ', position: '1B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .269' },
                { id: 'kt_9', name: 'ë¬¸ìƒì² ', position: '1B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .208' }
            ],
            'ì‚¼ì„±': [
                { id: 'samsung_1', name: 'ê¹€ì„±ìœ¤', position: 'CF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .331' },
                { id: 'samsung_2', name: 'êµ¬ììš±', position: 'LF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .315' },
                { id: 'samsung_3', name: 'ì´ì¬í˜„', position: 'SS', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .225' },
                { id: 'samsung_4', name: 'ê°•ë¯¼í˜¸', position: 'C', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .271' },
                { id: 'samsung_5', name: 'ê¹€ì˜ì›…', position: '3B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .256' },
                { id: 'samsung_6', name: 'ë¥˜ì§€í˜', position: '2B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .287' },
                { id: 'samsung_7', name: 'ì–‘ë„ê·¼', position: '2B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .268' },
                { id: 'samsung_8', name: 'ë°•ë³‘í˜¸', position: 'DH', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .202' },
                { id: 'samsung_9', name: 'ê¹€ì§€ì°¬', position: 'CF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .268' }
            ],
            'KIA': [
                { id: 'kia_1', name: 'ìµœí˜•ìš°', position: 'DH', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .313' },
                { id: 'kia_2', name: 'ë°•ì°¬í˜¸', position: 'SS', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .278' },
                { id: 'kia_3', name: 'ê¹€íƒœêµ°', position: 'C', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .275' },
                { id: 'kia_4', name: 'ê¹€í˜¸ë ¹', position: 'CF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .266' },
                { id: 'kia_5', name: 'ë‚˜ì„±ë²”', position: 'RF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .278' },
                { id: 'kia_6', name: 'ê¹€ì„ ë¹ˆ', position: '2B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .306' },
                { id: 'kia_7', name: 'í•œì¤€ìˆ˜', position: 'C', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .246' },
                { id: 'kia_8', name: 'ì˜¤ì„ ìš°', position: '1B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .281' }
            ],
            'ë‘ì‚°': [
                { id: 'doosan_1', name: 'ì–‘ì˜ì§€', position: 'C', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .336' },
                { id: 'doosan_2', name: 'ì •ìˆ˜ë¹ˆ', position: 'CF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .273' },
                { id: 'doosan_3', name: 'ì˜¤ëª…ì§„', position: '2B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .277' },
                { id: 'doosan_4', name: 'ê°•ìŠ¹í˜¸', position: '3B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .231' },
                { id: 'doosan_5', name: 'ê¹€ì¬í™˜', position: 'DH', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .239' },
                { id: 'doosan_6', name: 'ì´ìœ ì°¬', position: 'SS', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .257' },
                { id: 'doosan_7', name: 'ì–‘ì„í™˜', position: '1B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .242' },
                { id: 'doosan_8', name: 'ê¹€ì¸íƒœ', position: 'LF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .235' },
                { id: 'doosan_9', name: 'ì„ì¢…ì„±', position: '3B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .277' },
                { id: 'doosan_10', name: 'ì•ˆì¬ì„', position: 'DH', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .414' },
                { id: 'doosan_11', name: 'ë°•ì¤€ìˆœ', position: '3B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .300' },
                { id: 'doosan_12', name: 'ë°•ê³„ë²”', position: '2B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .250' }
            ],
            'NC': [
                { id: 'nc_1', name: 'ê¹€ì£¼ì›', position: 'SS', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .299' },
                { id: 'nc_2', name: 'ë°•ë¯¼ìš°', position: '2B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .301' },
                { id: 'nc_3', name: 'ê¹€í˜•ì¤€', position: 'C', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .234' },
                { id: 'nc_4', name: 'ê¶Œí¬ë™', position: 'LF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .235' },
                { id: 'nc_5', name: 'ìµœì •ì›', position: 'CF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .283' },
                { id: 'nc_6', name: 'ê¹€íœ˜ì§‘', position: '3B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .228' },
                { id: 'nc_7', name: 'ë°•ê±´ìš°', position: 'RF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .282' },
                { id: 'nc_8', name: 'ì†ì•„ì„­', position: 'RF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .300' },
                { id: 'nc_9', name: 'ê¹€í•œë³„', position: '3B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .316' }
            ],
            'í‚¤ì›€': [
                { id: 'kiwoom_1', name: 'ì†¡ì„±ë¬¸', position: '3B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .309' },
                { id: 'kiwoom_2', name: 'ì´ì£¼í˜•', position: 'CF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .247' },
                { id: 'kiwoom_3', name: 'ì„ì§€ì—´', position: 'LF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .247' },
                { id: 'kiwoom_4', name: 'ìµœì£¼í™˜', position: '1B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .272' },
                { id: 'kiwoom_5', name: 'ë°•ì£¼í™', position: 'RF', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .231' },
                { id: 'kiwoom_6', name: 'ê¹€ê±´í¬', position: 'C', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .245' },
                { id: 'kiwoom_7', name: 'ì˜¤ì„ ì§„', position: 'SS', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .215' },
                { id: 'kiwoom_8', name: 'ì „íƒœí˜„', position: '2B', image: 'ğŸ‘¤', stats: 'íƒ€ìœ¨ .236' }
            ]
        };

        // íˆ¬ìˆ˜ ë°ì´í„°
        const pitchers = {
            'LG': [
                { id: 'lg_p1', name: 'ì„ì°¬ê·œ', position: 'P', image: 'ğŸ‘¤', stats: 'ERA 2.90' },
                { id: 'lg_p2', name: 'ì†ì£¼ì˜', position: 'P', image: 'ğŸ‘¤', stats: 'ERA 3.80' }
            ],
            'í•œí™”': [
                { id: 'hanwha_p1', name: 'ë¬¸ë™ì£¼', position: 'P', image: 'ğŸ‘¤', stats: 'ERA 3.54' },
                { id: 'hanwha_p2', name: 'ë¥˜í˜„ì§„', position: 'P', image: 'ğŸ‘¤', stats: 'ERA 3.92' }
            ],
            'ë¡¯ë°': [
                { id: 'lotte_p1', name: 'ë‚˜ê· ì•ˆ', position: 'P', image: 'ğŸ‘¤', stats: 'ERA 4.61' },
                { id: 'lotte_p2', name: 'ë°•ì„¸ì›…', position: 'P', image: 'ğŸ‘¤', stats: 'ERA 5.56' }
            ],
            'SSG': [
                { id: 'ssg_p1', name: 'ì˜¤ì›ì„', position: 'P', image: 'ğŸ‘¤', stats: 'ERA 3.61' },
                { id: 'ssg_p2', name: 'ê¹€ê´‘í˜„', position: 'P', image: 'ğŸ‘¤', stats: 'ERA 4.79' }
            ],
            'KT': [
                { id: 'kt_p1', name: 'ê³ ì˜í‘œ', position: 'P', image: 'ğŸ‘¤', stats: 'ERA 3.54' },
                { id: 'kt_p2', name: 'ì†Œí˜•ì¤€', position: 'P', image: 'ğŸ‘¤', stats: 'ERA 3.80' }
            ],
            'ì‚¼ì„±': [
                { id: 'samsung_p1', name: 'ì›íƒœì¸', position: 'P', image: 'ğŸ‘¤', stats: 'ERA 3.52' },
                { id: 'samsung_p2', name: 'ìµœì›íƒœ', position: 'P', image: 'ğŸ‘¤', stats: 'ERA 4.76' },
                { id: 'samsung_p3', name: 'ì´ìŠ¹í˜„', position: 'P', image: 'ğŸ‘¤', stats: 'ERA 4.85' }
            ],
            'KIA': [
                { id: 'kia_p1', name: 'ì–‘í˜„ì¢…', position: 'P', image: 'ğŸ‘¤', stats: 'ERA 5.27' },
                { id: 'kia_p2', name: 'ê¹€ë„í˜„', position: 'P', image: 'ğŸ‘¤', stats: 'ERA 5.61' }
            ],
            'ë‘ì‚°': [
                { id: 'doosan_p1', name: 'ìµœìŠ¹ìš©', position: 'P', image: 'ğŸ‘¤', stats: 'ERA 4.30' }
            ],
            'NC': [
                { id: 'nc_p1', name: 'ì‹ ë¯¼í˜', position: 'P', image: 'ğŸ‘¤', stats: 'ERA 5.77' }
            ],
            'í‚¤ì›€': [
                { id: 'kiwoom_p1', name: 'í•˜ì˜ë¯¼', position: 'P', image: 'ğŸ‘¤', stats: 'ERA 5.41' },
                { id: 'kiwoom_p2', name: 'ê¹€ìœ¤í•˜', position: 'P', image: 'ğŸ‘¤', stats: 'ERA 7.77' }
            ]
        };

        // ìƒíƒœ ë³€ìˆ˜
        let selectedPlayers = {};
        let usedTeams = new Set();
        let lineup = Array(10).fill(null);
        let currentPosition = null;

        // ë“œë˜ê·¸ì•¤ë“œë¡­ ìƒíƒœ ë³€ìˆ˜
        let draggedIndex = null;

        // ì´ˆê¸°í™”
        function init() {
            renderTeamStatus();
            renderField();
            renderLineup();
            updateSelectedCount();
        }

        // íŒ€ ìƒíƒœ ë Œë”ë§
        function renderTeamStatus() {
            const container = document.getElementById('teamStatus');
            container.innerHTML = '';
            
            Object.entries(teams).forEach(([teamKey, teamInfo]) => {
                const isUsed = usedTeams.has(teamKey);
                const div = document.createElement('div');
                div.className = `p-1 sm:p-2 rounded-lg border transition-all text-center ${
                    isUsed ? 'bg-red-500/20 border-red-500 text-red-300' : 'bg-green-500/20 border-green-500 text-green-300'
                }`;
                div.style.minWidth = '60px';
                div.innerHTML = `
                    <div class="text-sm sm:text-lg">${teamInfo.logo}</div>
                    <div class="text-xs font-bold">${teamKey}</div>
                    <div class="text-xs mt-1">${isUsed ? 'ì‚¬ìš©' : 'ê°€ëŠ¥'}</div>
                `;
                container.appendChild(div);
            });
        }

        // ì•¼êµ¬ì¥ ë Œë”ë§
        function renderField() {
            const container = document.getElementById('fieldPositions');
            container.innerHTML = '';
            
            Object.entries(positions).forEach(([pos, info]) => {
                const player = selectedPlayers[pos];
                const teamInfo = player ? teams[player.team] : null;
                
                const div = document.createElement('div');
                div.className = 'absolute transform -translate-x-1/2 -translate-y-1/2 cursor-pointer z-20';
                div.style.left = info.x;
                div.style.top = info.y;
                div.onclick = () => openPlayerSelection(pos);
                
                if (player) {
                    div.innerHTML = `
                        <div class="group relative">
                            <div class="player-card rounded-lg border-2 shadow-2xl transform hover:scale-110 transition-all duration-300 hover:rotate-2"
                                 style="background: linear-gradient(135deg, ${teamInfo.color}, ${teamInfo.subColor}dd); border-color: ${teamInfo.color}; box-shadow: 0 8px 25px ${teamInfo.color}60;">
                                <div class="p-2 text-center h-full flex flex-col justify-between">
                                    <div class="text-2xl sm:text-3xl">${player.image}</div>
                                    <div>
                                        <div class="text-white text-xs sm:text-sm font-bold truncate">${player.name}</div>
                                        <div class="text-xs text-white/90 bg-black/40 rounded px-1 mt-1">
                                            ${teamInfo.name.split(' ')[0]}
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 opacity-0 group-hover:opacity-100 transition-opacity pointer-events-none z-50">
                                <div class="bg-black/90 text-white text-xs p-2 rounded-lg whitespace-nowrap">
                                    ${player.stats}
                                </div>
                            </div>
                            
                            <button onclick="event.stopPropagation(); removePlayer('${pos}');" class="absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity shadow-lg hover:bg-red-600 flex items-center justify-center z-30 text-xs">
                                Ã—
                            </button>
                        </div>
                    `;
                } else {
                    div.innerHTML = `
                        <div class="relative">
                            <div class="player-card rounded-lg border-3 border-dashed border-gray-400 bg-white/80 backdrop-blur-sm flex flex-col items-center justify-center hover:border-blue-500 hover:bg-blue-50 transition-all duration-300 transform hover:scale-105 shadow-lg">
                                <div class="text-gray-600 text-center">
                                    <div class="text-3xl mb-2 animate-pulse">+</div>
                                    <div class="text-xs font-bold mb-1">${info.name}</div>
                                    <div class="text-xs opacity-70 bg-gray-200 rounded px-1">${pos}</div>
                                </div>
                            </div>
                        </div>
                    `;
                }
                
                container.appendChild(div);
            });
        }

        // ë¼ì¸ì—… ë Œë”ë§
        function renderLineup() {
            const container = document.getElementById('lineup');
            container.innerHTML = '';
            
            // íƒ€ì 9ëª…
            for (let i = 0; i < 9; i++) {
                const player = lineup[i];
                const div = document.createElement('div');
                div.className = 'lineup-item flex-shrink-0';
                
                div.innerHTML = `
                    <div class="text-center mb-2">
                        <span class="text-sm font-bold text-yellow-400">${i + 1}ë²ˆ</span>
                    </div>
                    ${player ? `
                        <div class="w-16 h-20 sm:w-20 sm:h-24 p-2 rounded-lg shadow-lg border-2 cursor-move transition-all hover:scale-105"
                             style="background: linear-gradient(135deg, ${teams[player.team].color}cc, ${teams[player.team].subColor}cc); border-color: ${teams[player.team].color};"
                             draggable="true" ondragstart="dragStart(event, ${i})" ondragover="dragOver(event)" ondragleave="dragLeave(event)" ondrop="drop(event, ${i})">
                            <div class="text-center h-full flex flex-col justify-between">
                                <div class="text-lg sm:text-xl">${player.image}</div>
                                <div>
                                    <div class="text-white text-xs font-bold truncate">${player.name}</div>
                                    <div class="text-xs text-white/80 bg-black/30 rounded px-1 mt-1">
                                        ${teams[player.team].name.split(' ')[0]}
                                    </div>
                                </div>
                            </div>
                        </div>
                    ` : `
                        <div class="w-16 h-20 sm:w-20 sm:h-24 border-2 border-dashed border-white/30 rounded-lg flex items-center justify-center">
                            <span class="text-white/50 text-xs">ëŒ€ê¸°</span>
                        </div>
                    `}
                `;
                container.appendChild(div);
            }
            
            // ê°„ê²©
            const spacer = document.createElement('div');
            spacer.className = 'w-6';
            container.appendChild(spacer);
            
            // íˆ¬ìˆ˜
            const pitcher = lineup[9];
            const pitcherDiv = document.createElement('div');
            pitcherDiv.className = 'flex-shrink-0';
            pitcherDiv.innerHTML = `
                <div class="text-center mb-2">
                    <span class="text-sm font-bold text-yellow-400">ì„ ë°œíˆ¬ìˆ˜</span>
                </div>
                ${pitcher ? `
                    <div class="w-16 h-20 sm:w-20 sm:h-24 p-2 rounded-lg shadow-lg border-2 transition-all hover:scale-105"
                         style="background: linear-gradient(135deg, ${teams[pitcher.team].color}cc, ${teams[pitcher.team].subColor}cc); border-color: ${teams[pitcher.team].color};">
                        <div class="text-center h-full flex flex-col justify-between">
                            <div class="text-lg sm:text-xl">${pitcher.image}</div>
                            <div>
                                <div class="text-white text-xs font-bold truncate">${pitcher.name}</div>
                                <div class="text-xs text-white/80 bg-black/30 rounded px-1 mt-1">
                                    ${teams[pitcher.team].name.split(' ')[0]}
                                </div>
                            </div>
                        </div>
                    </div>
                ` : `
                    <div class="w-16 h-20 sm:w-20 sm:h-24 border-2 border-dashed border-white/30 rounded-lg flex items-center justify-center">
                        <span class="text-white/50 text-xs">ëŒ€ê¸°</span>
                    </div>
                `}
            `;
            container.appendChild(pitcherDiv);
        }

        // ì„ íƒëœ ì„ ìˆ˜ ìˆ˜ ì—…ë°ì´íŠ¸
        function updateSelectedCount() {
            const count = Object.keys(selectedPlayers).length;
            document.getElementById('selectedCount').innerText = `${count}/10`;
            const saveBtn = document.getElementById('saveBtn');
            saveBtn.disabled = count !== 10;
        }

        // ì„ ìˆ˜ ì„ íƒ ëª¨ë‹¬ ì—´ê¸°
        function openPlayerSelection(pos) {
            currentPosition = pos;
            const modal = document.getElementById('playerSelectionModal');
            const playerList = document.getElementById('playerList');
            const modalTitle = document.getElementById('modalTitle');
            playerList.innerHTML = '';
            
            const posName = positions[pos].name;
            modalTitle.innerText = `${posName} ì„ ìˆ˜ ì„ íƒ`;
            
            let availablePlayers = [];
            
            Object.keys(teams).forEach(teamKey => {
                const teamPlayers = players[teamKey] || [];
                const teamPitchers = pitchers[teamKey] || [];
                
                let filteredPlayers = [];
                if (pos === 'P') {
                    filteredPlayers = teamPitchers;
                } else {
                    filteredPlayers = teamPlayers.filter(p => p.position === pos || pos === 'DH');
                }
                
                // ì´ë¯¸ ì‚¬ìš©ëœ íŒ€ì˜ ì„ ìˆ˜ëŠ” ì œì™¸
                if (!usedTeams.has(teamKey)) {
                    availablePlayers = availablePlayers.concat(filteredPlayers.map(p => ({
                        ...p,
                        team: teamKey
                    })));
                } else {
                    // í˜„ì¬ í¬ì§€ì…˜ì— ì„ íƒëœ ì„ ìˆ˜ê°€ í•´ë‹¹ íŒ€ ì†Œì†ì¸ ê²½ìš°, ëª©ë¡ì— í¬í•¨
                    const selectedPlayer = Object.values(selectedPlayers).find(sp => sp.team === teamKey && sp.positionInTeam === pos);
                    if (selectedPlayer) {
                        availablePlayers.push(selectedPlayer);
                    }
                }
            });
            
            if (availablePlayers.length > 0) {
                availablePlayers.forEach(player => {
                    const playerCard = createPlayerCard(player, pos);
                    playerList.appendChild(playerCard);
                });
            } else {
                playerList.innerHTML = `<p class="col-span-full text-center text-gray-400">ì„ íƒ ê°€ëŠ¥í•œ ì„ ìˆ˜ê°€ ì—†ìŠµë‹ˆë‹¤.</p>`;
            }
            
            modal.classList.remove('hidden');
        }

        // ì„ ìˆ˜ ì¹´ë“œ ìƒì„±
        function createPlayerCard(player, currentPos) {
            const card = document.createElement('div');
            const teamInfo = teams[player.team];
            const isSelected = Object.values(selectedPlayers).some(p => p.id === player.id);
            const isUsedTeam = usedTeams.has(player.team) && !isSelected;

            card.className = `p-2 rounded-lg border-2 shadow-lg text-center cursor-pointer transition-all relative ${
                isUsedTeam ? 'bg-gray-700/50 border-gray-600 cursor-not-allowed' : 'hover:scale-105'
            }`;
            card.style.background = `linear-gradient(135deg, ${teamInfo.color}, ${teamInfo.subColor}dd)`;
            card.style.borderColor = teamInfo.color;
            
            if (isUsedTeam) {
                card.classList.add('opacity-50');
            } else {
                card.onclick = () => selectPlayer(player);
            }

            card.innerHTML = `
                <div class="text-xl sm:text-2xl">${player.image}</div>
                <div class="mt-1 text-white text-sm font-bold truncate">${player.name}</div>
                <div class="text-xs text-white/80 bg-black/30 rounded px-1 mt-1 truncate">
                    ${teamInfo.name.split(' ')[0]} ${player.position}
                </div>
                <div class="text-xs text-white/70 mt-1">${player.stats}</div>
                ${isSelected ? `<span class="absolute top-1 right-1 text-yellow-400 text-sm">âœ…</span>` : ''}
                ${isUsedTeam ? `<span class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-white font-bold bg-black/70 px-2 py-1 rounded-full text-xs">ì‚¬ìš©ë¨</span>` : ''}
            `;
            
            return card;
        }
        
        // ì„ ìˆ˜ ì„ íƒ
        function selectPlayer(player) {
            const oldPlayer = selectedPlayers[currentPosition];

            if (oldPlayer && oldPlayer.team !== player.team) {
                usedTeams.delete(oldPlayer.team);
            }
            
            // ê¸°ì¡´ì— ì„ íƒëœ ì„ ìˆ˜ê°€ ìˆìœ¼ë©´ ë¼ì¸ì—…ì—ì„œ ì œê±°
            if (oldPlayer) {
                const oldIndex = lineup.findIndex(p => p && p.id === oldPlayer.id);
                if (oldIndex !== -1) {
                    lineup[oldIndex] = null;
                }
            }

            // ìƒˆë¡œìš´ ì„ ìˆ˜ ì„ íƒ
            selectedPlayers[currentPosition] = { ...player, positionInTeam: currentPosition };
            usedTeams.add(player.team);

            if (currentPosition === 'P') {
                lineup[9] = selectedPlayers['P'];
            } else {
                const availableSlot = lineup.findIndex(p => p === null);
                if (availableSlot !== -1) {
                    lineup[availableSlot] = selectedPlayers[currentPosition];
                } else {
                    // ì´ë¯¸ ë¼ì¸ì—…ì´ ë‹¤ ì°¼ì„ ê²½ìš°, êµì²´ë˜ëŠ” íƒ€ìì˜ ìœ„ì¹˜ë¡œ
                    const oldIndex = lineup.findIndex(p => p && p.id === oldPlayer?.id);
                    if (oldIndex !== -1) {
                        lineup[oldIndex] = selectedPlayers[currentPosition];
                    }
                }
            }

            closePlayerModal();
            renderField();
            renderLineup();
            renderTeamStatus();
            updateSelectedCount();
        }

        // ì„ ìˆ˜ ì œê±°
        function removePlayer(pos) {
            const playerToRemove = selectedPlayers[pos];
            if (!playerToRemove) return;
            
            delete selectedPlayers[pos];
            
            // ë¼ì¸ì—…ì—ì„œ ì„ ìˆ˜ ì œê±°
            const indexInLineup = lineup.findIndex(p => p && p.id === playerToRemove.id);
            if (indexInLineup !== -1) {
                lineup[indexInLineup] = null;
            }

            // í•´ë‹¹ íŒ€ì˜ ë‹¤ë¥¸ ì„ ìˆ˜ê°€ ìˆëŠ”ì§€ í™•ì¸
            const isTeamUsedElsewhere = Object.values(selectedPlayers).some(p => p.team === playerToRemove.team);
            if (!isTeamUsedElsewhere) {
                usedTeams.delete(playerToRemove.team);
            }
            
            renderField();
            renderLineup();
            renderTeamStatus();
            updateSelectedCount();
        }

        // ëª¨ë‹¬ ë‹«ê¸°
        function closePlayerModal() {
            document.getElementById('playerSelectionModal').classList.add('hidden');
        }
        
        function showRulesModal() {
            document.getElementById('rulesModal').classList.remove('hidden');
        }
        
        function closeRulesModal() {
            document.getElementById('rulesModal').classList.add('hidden');
        }

        // ì „ì²´ ì´ˆê¸°í™”
        function resetTeam() {
            selectedPlayers = {};
            usedTeams.clear();
            lineup = Array(10).fill(null);
            init();
        }

        // ì´ë¯¸ì§€ ì €ì¥ ê¸°ëŠ¥
        function saveAsImage() {
            const captureArea = document.getElementById('captureArea');
            const originalBg = captureArea.style.backgroundColor;
            const originalPadding = captureArea.style.padding;
            
            // ìº¡ì²˜ ì‹œ ë°°ê²½ìƒ‰ì„ í°ìƒ‰ìœ¼ë¡œ ì„ì‹œ ë³€ê²½
            captureArea.style.backgroundColor = 'white';
            captureArea.style.padding = '10px';

            html2canvas(captureArea, {
                allowTaint: true,
                useCORS: true,
                scale: 2 
            }).then(function(canvas) {
                // ë°°ê²½ìƒ‰ê³¼ íŒ¨ë”©ì„ ì›ë˜ëŒ€ë¡œ ë˜ëŒë¦¼
                captureArea.style.backgroundColor = originalBg;
                captureArea.style.padding = originalPadding;
                
                const link = document.createElement('a');
                link.href = canvas.toDataURL('image/png');
                link.download = `ë‚˜ì˜_KBO_ë“œë¦¼íŒ€_${new Date().toLocaleDateString()}.png`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            });
        }
        
        // ë“œë˜ê·¸ì•¤ë“œë¡­ í•¨ìˆ˜
        function dragStart(e, index) {
            draggedIndex = index;
            e.dataTransfer.effectAllowed = 'move';
            e.dataTransfer.setData('text/plain', index);
            setTimeout(() => {
                e.target.style.opacity = '0.5';
            }, 0);
        }
        
        function dragOver(e) {
            e.preventDefault();
            const targetElement = e.currentTarget;
            if (targetElement.classList.contains('lineup-item')) {
                targetElement.classList.add('drag-over');
            }
            e.dataTransfer.dropEffect = 'move';
        }
        
        function dragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }
        
        function drop(e, targetIndex) {
            e.preventDefault();
            e.currentTarget.classList.remove('drag-over');
            
            const sourceIndex = draggedIndex;
            if (sourceIndex === null || sourceIndex === targetIndex) return;

            const temp = lineup[sourceIndex];
            lineup[sourceIndex] = lineup[targetIndex];
            lineup[targetIndex] = temp;
            
            document.querySelector(`[ondragstart*="dragStart(event, ${sourceIndex})"]`).style.opacity = '1';
            
            renderLineup();
            draggedIndex = null;
        }

        // ì´ˆê¸° ì‹¤í–‰
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>